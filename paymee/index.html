<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Paymee SoftPOS App Mockup</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --color-coral:#FF6B81; --color-cyan:#A5E4FF; --color-lavender:#D9C6FF;
      --color-smoke:#F7F8FA; --color-dark:#0A0A0A; --color-card-bg:#FFFFFF;
    }
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

    body{
      font-family:'Inter',sans-serif;
      background-color: var(--color-dark);
      margin:0;
      min-height:100svh;
    }

    /* Phone mockup: ahora RESPONSIVE */
    .phone-container{
      width: clamp(320px, 90vw, 420px);
      height: clamp(568px, 90vh, 900px);
      background-color: var(--color-dark);
      border-radius: 40px;
      overflow: hidden;
      margin: 0 auto;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,.7);
      position: relative;
    }

    .app-screen{
      width:100%; height:100%;
      position:absolute; inset:0;
      transform: translateX(100%);
      transition: transform .3s ease-in-out;
      background:#fff; color:#1f2937;
      display:flex; flex-direction:column;
      padding-bottom:70px; /* espacio para navbar */
      overflow-y:auto;
    }
    .app-screen.active{ transform: translateX(0); }

    .paymee-navbar{
      position:absolute; left:0; bottom:0; width:100%; height:70px;
      background:#fff; border-top:1px solid #f0f0f0; box-shadow:0 -4px 12px rgba(0,0,0,.03);
      z-index:10; display:flex; justify-content:space-around; align-items:center;
    }

    .bg-paymee-gradient{ background:linear-gradient(135deg,var(--color-coral) 0%,var(--color-cyan) 100%); }
    .text-paymee-cyan{ color:var(--color-cyan); }
    .text-paymee-coral{ color:var(--color-coral); }
    .paymee-card{ background:#fff; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,.05); transition: all .15s ease; }
    .tap-effect:active{ transform:scale(.98); }

    @keyframes pulse-logo{0%,100%{transform:scale(1);opacity:1;}50%{transform:scale(1.03);opacity:.9;}}
    .animate-pulse-logo{ animation:pulse-logo 2s infinite ease-in-out; }

    /* Logo "Paymee" con gradiente */
    .paymee-logo-text{
      background-image:linear-gradient(to right,var(--color-coral),var(--color-cyan));
      -webkit-background-clip:text; background-clip:text;
      color:transparent; font-size:clamp(28px,6vw,48px); font-weight:700; line-height:1;
    }

    /* keypad */
    .key-button{ border:none; cursor:pointer; }

    /* Mejora de scroll en iOS */
    .app-screen{ -webkit-overflow-scrolling: touch; }
  </style>
</head>
<body>

  <div class="phone-container" id="phone-container">
    <!-- SPLASH -->
    <div id="splash-screen" class="app-screen active !bg-white">
      <div class="flex flex-col items-center justify-center h-full bg-paymee-gradient">
        <div class="bg-white p-6 rounded-3xl shadow-xl">
          <img src="logo.png" alt="Paymee Logo" class="w-24 h-24 animate-pulse-logo">
        </div>
        <div class="paymee-logo-text mt-6">Paymee</div>
        <div class="text-white text-sm font-light tracking-widest mt-2 opacity-90">COBROS F√ÅCILES. SIN CONTACTO.</div>
      </div>
    </div>

    <!-- WELCOME -->
    <div id="welcome" class="app-screen justify-center items-center">
      <div class="flex flex-col items-center p-8 text-center">
        <img src="logo.png" alt="Paymee Logo" class="w-20 h-20">
        <h1 class="text-3xl font-bold mt-8 text-gray-800">¬°Bienvenido a Paymee!</h1>
        <p class="text-gray-500 mt-4">La manera m√°s r√°pida y segura de aceptar pagos con QR y Tap-to-Phone.</p>
        <button onclick="renderScreen('home-dashboard')" class="w-full mt-12 py-3 text-white font-semibold rounded-xl bg-paymee-gradient shadow-lg shadow-pink-300/50 hover:scale-[0.99] transition tap-effect">
          Comenzar
        </button>
      </div>
    </div>

    <!-- HOME DASHBOARD -->
    <div id="home-dashboard" class="app-screen p-6 overflow-y-auto">
      <div class="mb-6 pt-4">
        <h2 class="text-xl font-bold text-gray-800">Hola, Axel üëã</h2>
        <p class="text-sm text-gray-500">Resumen de tu d√≠a de cobros.</p>
      </div>

      <div class="paymee-card bg-paymee-gradient text-white p-6 mb-6 hover:scale-[0.99] transition tap-effect">
        <p class="text-sm opacity-80">Ganancias de Hoy</p>
        <h3 class="text-4xl font-extrabold mt-1">$ 15.650,00</h3>
        <div class="flex justify-between items-center mt-4 text-xs opacity-80">
          <span>3 Transacciones</span>
          <span class="bg-white/20 px-2 py-0.5 rounded-full">+12% vs ayer</span>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-8">
        <button onclick="renderScreen('collect-amount')" class="paymee-card p-4 flex flex-col items-start hover:scale-[0.98] transition tap-effect">
          <svg class="w-8 h-8 text-paymee-coral" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2M12 1c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9-4.03-9-9-9z"/></svg>
          <span class="mt-2 text-md font-semibold text-gray-800">Cobrar</span>
          <span class="text-xs text-gray-400">QR / NFC / Link</span>
        </button>
        <button onclick="renderScreen('history')" class="paymee-card p-4 flex flex-col items-start hover:scale-[0.98] transition tap-effect">
          <svg class="w-8 h-8 text-paymee-cyan" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-4 18h.01M3 21h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
          <span class="mt-2 text-md font-semibold text-gray-800">Historial</span>
          <span class="text-xs text-gray-400">Ver cobros</span>
        </button>
      </div>
    </div>

    <!-- INGRESAR MONTO -->
    <div id="collect-amount" class="app-screen flex-col justify-between">
      <div class="p-6 pt-4">
        <div class="flex items-center mb-6">
          <button onclick="renderScreen('home-dashboard')" class="text-gray-600 hover:text-gray-900 tap-effect"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg></button>
          <h2 class="text-xl font-bold text-gray-800 ml-4">Ingresa el Monto</h2>
        </div>
        <div class="text-center mt-12">
          <span class="text-4xl font-extrabold text-gray-800" id="display-amount">$ 0,00</span>
        </div>
      </div>

      <div class="w-full">
        <div class="grid grid-cols-3 gap-1 p-4">
          <button data-value="1" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">1</button>
          <button data-value="2" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">2</button>
          <button data-value="3" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">3</button>
          <button data-value="4" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">4</button>
          <button data-value="5" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">5</button>
          <button data-value="6" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">6</button>
          <button data-value="7" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">7</button>
          <button data-value="8" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">8</button>
          <button data-value="9" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">9</button>
          <button data-value="." class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">.</button>
          <button data-value="0" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg">0</button>
          <button data-action="delete" class="key-button py-4 text-3xl font-light text-gray-800 hover:bg-gray-100 rounded-lg flex justify-center items-center">
            <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l2-2m0 0l-2-2m2 2h4M7 6H5a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M7 6v4a2 2 0 002 2h2"/></svg>
          </button>
        </div>
        <div class="p-4">
          <button id="collect-generate-btn" onclick="renderScreen('collect-method')" class="w-full py-4 text-white font-semibold rounded-xl bg-gray-400 cursor-not-allowed transition" disabled>
            Generar Cobro
          </button>
        </div>
      </div>
    </div>

    <!-- SELECCIONAR M√âTODO -->
    <div id="collect-method" class="app-screen p-6">
      <div class="flex items-center mb-8 pt-4">
        <button onclick="renderScreen('collect-amount')" class="text-gray-600 hover:text-gray-900 tap-effect"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg></button>
        <h2 class="text-xl font-bold text-gray-800 ml-4">Selecciona el M√©todo</h2>
      </div>

      <div class="paymee-card p-6 mb-8 bg-paymee-gradient text-white">
        <p class="text-sm opacity-80">Monto a Cobrar</p>
        <h3 class="text-3xl font-extrabold" id="method-amount-display">$ 0,00</h3>
      </div>

      <div class="grid grid-cols-2 gap-4">
        <button onclick="renderScreen('qr-sim')" class="paymee-card p-4 flex flex-col items-center justify-center h-36 hover:bg-gray-50 hover:scale-[0.98] transition">
          <svg class="w-10 h-10 text-paymee-coral" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8v8m0-8v.01"/></svg>
          <span class="mt-2 text-md font-semibold text-gray-800">C√≥digo QR</span>
        </button>
        <button onclick="renderScreen('nfc-sim')" class="paymee-card p-4 flex flex-col items-center justify-center h-36 hover:bg-gray-50 hover:scale-[0.98] transition">
          <svg class="w-10 h-10 text-paymee-cyan" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
          <span class="mt-2 text-md font-semibold text-gray-800">Tap-to-Phone</span>
        </button>
      </div>
    </div>

    <!-- QR SIM -->
    <div id="qr-sim" class="app-screen p-6 items-center justify-start">
      <div class="flex items-center w-full mb-8 pt-4">
        <button onclick="renderScreen('collect-method')" class="text-gray-600 hover:text-gray-900 tap-effect"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg></button>
        <h2 class="text-xl font-bold text-gray-800 ml-4">Cobro con QR</h2>
      </div>
      <div class="text-center mb-8">
        <p class="text-lg text-gray-500">Monto Fijo</p>
        <h3 class="text-4xl font-bold text-gray-800" id="qr-amount-display">$ 0,00</h3>
      </div>
      <div class="w-64 h-64 bg-gray-200 rounded-lg flex items-center justify-center shadow-xl">
        <svg class="w-16 h-16 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354l-7 7m0 0l-7 7m7-7v14"/></svg>
      </div>
      <p class="text-sm text-gray-500 mt-6 text-center">Escanea este c√≥digo con cualquier billetera virtual.</p>
      <button onclick="renderScreen('success')" class="w-5/6 mt-12 py-3 text-white font-semibold rounded-xl bg-paymee-gradient shadow-lg hover:scale-[0.99] transition">
        Simular Pago Exitoso
      </button>
    </div>

    <!-- NFC SIM -->
    <div id="nfc-sim" class="app-screen p-6 items-center justify-start">
      <div class="flex items-center w-full mb-8 pt-4">
        <button onclick="renderScreen('collect-method')" class="text-gray-600 hover:text-gray-900 tap-effect"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg></button>
        <h2 class="text-xl font-bold text-gray-800 ml-4">Tap-to-Phone (NFC)</h2>
      </div>
      <div class="text-center mb-8">
        <p class="text-lg text-gray-500">Monto Fijo</p>
        <h3 class="text-4xl font-bold text-gray-800" id="nfc-amount-display">$ 0,00</h3>
      </div>
      <div class="w-56 h-56 bg-white rounded-full flex items-center justify-center mt-10 shadow-xl">
        <div class="w-32 h-32 bg-[#A5E4FF33] rounded-full flex items-center justify-center">
          <svg class="w-16 h-16 text-paymee-cyan" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
        </div>
      </div>
      <p class="text-lg font-semibold text-gray-700 mt-12 text-center">Acerca la tarjeta o el celular del cliente.</p>
      <p class="text-sm text-gray-500 mt-2 text-center">Esperando la confirmaci√≥n de pago...</p>
      <button onclick="renderScreen('success')" class="w-5/6 mt-12 py-3 text-white font-semibold rounded-xl bg-paymee-gradient shadow-lg hover:scale-[0.99] transition">
        Simular Pago Exitoso
      </button>
    </div>

    <!-- √âXITO -->
    <div id="success" class="app-screen p-6 items-center justify-center text-center">
      <div class="flex flex-col items-center">
        <div class="w-24 h-24 rounded-full bg-green-500/10 flex items-center justify-center mb-6">
          <svg class="w-12 h-12 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
        </div>
        <h2 class="text-3xl font-bold text-gray-800">¬°Cobro Exitoso!</h2>
        <h3 class="text-5xl font-extrabold text-gray-800 mt-4" id="success-amount-display">$ 0,00</h3>
        <p class="text-gray-500 mt-2">Monto acreditado a tu cuenta.</p>
        <button onclick="renderScreen('receipt')" class="w-64 mt-10 py-3 text-paymee-cyan font-semibold rounded-xl border border-paymee-cyan hover:bg-paymee-cyan/10 transition">Ver Comprobante</button>
        <button onclick="renderScreen('home-dashboard')" class="w-64 mt-3 py-3 text-gray-700 font-semibold rounded-xl hover:bg-gray-100 transition">Volver al Inicio</button>
      </div>
    </div>

    <!-- COMPROBANTE -->
    <div id="receipt" class="app-screen p-6 overflow-y-auto">
      <div class="flex items-center w-full mb-8 pt-4">
        <button onclick="renderScreen('success')" class="text-gray-600 hover:text-gray-900 tap-effect"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg></button>
        <h2 class="text-xl font-bold text-gray-800 ml-4">Comprobante Digital</h2>
      </div>
      <div class="paymee-card p-6 border-t-8" style="border-color: var(--color-cyan);">
        <div class="text-center border-b border-gray-100 pb-4 mb-4">
          <p class="text-2xl font-bold text-gray-800" id="receipt-total">$ 0,00</p>
          <p class="text-sm text-gray-500">Monto Total</p>
        </div>
        <div class="space-y-3">
          <div class="flex justify-between text-sm text-gray-600"><span>Fecha</span><span id="receipt-date">10/10/2025 10:30 AM</span></div>
          <div class="flex justify-between text-sm text-gray-600"><span>M√©todo</span><span id="receipt-method">Tap-to-Phone</span></div>
          <div class="flex justify-between text-sm text-gray-600"><span>C√≥d. de Transacci√≥n</span><span id="receipt-code">PYM-8374829X</span></div>
          <div class="flex justify-between text-sm text-gray-600"><span>Comisi√≥n (3%)</span><span class="text-red-500" id="receipt-fee">$ 0,00</span></div>
          <div class="flex justify-between text-lg font-bold text-gray-800 pt-3 border-t border-dashed border-gray-200">
            <span>Monto Acreditado</span><span id="receipt-net">$ 0,00</span>
          </div>
        </div>
      </div>
      <button class="w-full mt-8 py-3 text-white font-semibold rounded-xl bg-paymee-gradient hover:scale-[0.99] transition">Enviar por Email/WhatsApp</button>
    </div>

    <!-- NAVBAR -->
    <div class="paymee-navbar" id="main-navbar">
      <button onclick="renderScreen('home-dashboard')" data-screen="home-dashboard" class="nav-item flex flex-col items-center p-2 tap-effect">
        <svg class="w-6 h-6 text-paymee-cyan nav-icon" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/></svg>
        <span class="text-xs text-paymee-cyan mt-1">Inicio</span>
      </button>
      <button onclick="renderScreen('collect-amount')" data-screen="collect-amount" class="nav-item flex flex-col items-center p-2 tap-effect">
        <svg class="w-6 h-6 text-gray-400 nav-icon" fill="currentColor" viewBox="0 0 20 20"><path d="M4 4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zM6 8a2 2 0 012-2h4a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2V8z"/></svg>
        <span class="text-xs text-gray-400 mt-1">Cobrar</span>
      </button>
      <button onclick="renderScreen('history')" data-screen="history" class="nav-item flex flex-col items-center p-2 tap-effect">
        <svg class="w-6 h-6 text-gray-400 nav-icon" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm6 12a1 1 0 100-2 1 1 0 000 2zM9 9a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/></svg>
        <span class="text-xs text-gray-400 mt-1">Historial</span>
      </button>
      <button onclick="renderScreen('home-dashboard')" data-screen="daily-summary" class="nav-item flex flex-col items-center p-2 tap-effect">
        <svg class="w-6 h-6 text-gray-400 nav-icon" fill="currentColor" viewBox="0 0 20 20"><path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/></svg>
        <span class="text-xs text-gray-400 mt-1">Resumen</span>
      </button>
    </div>
  </div>

  <script>
    // --- ESTADO ---
    let currentScreen = 'splash-screen';
    let amount = '000'; // centavos (string)

    const navbar = document.getElementById('main-navbar');
    const navItems = document.querySelectorAll('.nav-item');

    // --- UTILIDADES ---
    const formatAmount = (value) => {
      const numberValue = parseFloat(value) || 0;
      return new Intl.NumberFormat('es-AR', { style:'currency', currency:'ARS', minimumFractionDigits:2 }).format(numberValue);
    };

    const updateDisplay = () => {
      const display = document.getElementById('display-amount');
      if (display){
        let displayValue = amount.replace(/[^\d]/g,'');
        if (displayValue.length < 3) displayValue = '000'.substring(0,3-displayValue.length)+displayValue;
        const formatted = displayValue.slice(0,-2)+','+displayValue.slice(-2);
        let integerPart = formatted.slice(0, formatted.length-3);
        const decimalPart = formatted.slice(-2);
        integerPart = integerPart.replace(/^0+/,''); if (integerPart==='') integerPart='0';
        integerPart = integerPart.replace(/\B(?=(\d{3})+(?!\d))/g,'.');
        display.textContent = `$ ${integerPart},${decimalPart}`;
      }
      const btn = document.getElementById('collect-generate-btn');
      if (btn){
        const isValid = parseInt(amount)>0;
        btn.disabled = !isValid;
        btn.className = `w-full py-4 text-white font-semibold rounded-xl transition ${isValid ? 'bg-paymee-gradient shadow-lg hover:scale-[0.99] cursor-pointer' : 'bg-gray-400 cursor-not-allowed'}`;
      }
    };

    const handleKeyPress = (value) => {
      let cleanAmount = amount.replace(/[^\d]/g,'');
      if (value === 'delete') cleanAmount = cleanAmount.length>1 ? cleanAmount.slice(0,-1) : '0';
      else if (/[0-9]/.test(value)) cleanAmount = (cleanAmount==='0') ? value : cleanAmount+value;
      amount = cleanAmount;
      updateDisplay();
    };

    const calculateReceipt = (totalAmountInCents) => {
      const total = (parseFloat(totalAmountInCents) / 100);
      const feeRate = 0.03;
      const fee = total * feeRate;
      const net = total - fee;
      return {
        total: formatAmount(total.toFixed(2)),
        fee:   formatAmount(fee.toFixed(2)),
        net:   formatAmount(net.toFixed(2)),
        method: currentScreen === 'qr-sim' ? 'QR Interoperable' : 'Tap-to-Phone (NFC)'
      };
    };

    // Historial (mock)
    const transactions = [
      { id:'TX-001', amount:1245000, method:'NFC', network:'Visa D√©bito',        time:'12:35', status:'approved' },
      { id:'TX-002', amount:2320000, method:'QR',  network:'Billetera Cliente',  time:'11:02', status:'approved' },
      { id:'TX-003', amount: 875000, method:'QR',  network:'MercadoPago',        time:'10:41', status:'refunded' },
      { id:'TX-004', amount:1450000, method:'NFC', network:'Mastercard Cr√©dito', time:'09:24', status:'approved' },
    ];

    const METHOD_ICONS = {
      NFC:`<svg class="w-6 h-6 text-paymee-cyan" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>`,
      QR:`<svg class="w-6 h-6 text-paymee-coral" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4h6v6H4zM14 4h6v6h-6zM4 14h6v6H4zM16 14h-2v2h2v4h4v-4h-2v-2h2v-2h-4z"/></svg>`
    };

    function statusBadge(status){
      if (status==='approved') return `<span class="text-xs px-3 py-1.5 rounded-full bg-green-100 text-green-700 border border-green-200">Aprobado</span>`;
      if (status==='refunded') return `<span class="text-xs px-3 py-1.5 rounded-full bg-gray-100 text-gray-700 border border-gray-200">Reembolsado</span>`;
      return `<span class="text-xs px-3 py-1.5 rounded-full bg-yellow-100 text-yellow-800 border border-yellow-200">Pendiente</span>`;
    }

    function renderHistory(list){
      const container = document.getElementById('history-list');
      const totalEl = document.getElementById('history-total');
      if (!container || !totalEl) return;

      container.innerHTML = list.map(tx=>{
        const icon = METHOD_ICONS[tx.method] || '';
        const amount = formatAmount((tx.amount/100).toFixed(2));
        const line2 = `${tx.method} ‚Ä¢ ${tx.network} ‚Ä¢ ${tx.time}`;
        return `
          <div class="paymee-card p-4 flex items-center justify-between hover:scale-[0.99] transition">
            <div class="flex items-center gap-3">
              <div class="w-11 h-11 rounded-xl bg-gray-100 flex items-center justify-center">${icon}</div>
              <div>
                <div class="text-gray-900 font-semibold leading-tight">${amount}</div>
                <div class="text-xs text-gray-500">${line2}</div>
              </div>
            </div>
            ${statusBadge(tx.status)}
          </div>`;
      }).join('');

      const total = list.reduce((acc,tx)=>acc+tx.amount,0)/100;
      totalEl.textContent = formatAmount(total.toFixed(2));
    }

    function exportHistoryToCSV(list){
      const header=['id','monto_AR','metodo','red','hora','estado'];
      const rows=list.map(tx=>([tx.id,(tx.amount/100).toFixed(2).replace('.',','),tx.method,tx.network,tx.time,tx.status]));
      const csv=[header,...rows].map(r=>r.map(v=>`"${String(v).replace(/"/g,'""')}"`).join(',')).join('\n');
      const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'}); const url=URL.createObjectURL(blob);
      const a=document.createElement('a'); a.href=url; a.download=`historial_cobros_${new Date().toISOString().slice(0,10)}.csv`;
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }

    function initHistory(){
      renderHistory(transactions);
      const btnToday=document.getElementById('btnToday');
      const btnFilters=document.getElementById('btnFilters');
      const btnExport=document.getElementById('btnExport');
      btnToday  && btnToday.addEventListener('click',()=>renderHistory(transactions));
      btnFilters&& btnFilters.addEventListener('click',()=>renderHistory(transactions.filter(t=>t.status==='approved')));
      btnExport && btnExport.addEventListener('click',()=>exportHistoryToCSV(transactions));
    }

    // NAV
    const updateNavHighlight = (targetId)=>{
      document.querySelectorAll('.nav-item').forEach(item=>{
        const icon=item.querySelector('svg'); const text=item.querySelector('span');
        const targetScreenName=item.getAttribute('data-screen');
        const isActive = targetId===targetScreenName || (targetId==='collect-amount' && targetScreenName==='collect-amount');
        if(isActive){ icon.classList.replace('text-gray-400','text-paymee-cyan'); text.classList.replace('text-gray-400','text-paymee-cyan'); }
        else{ icon.classList.replace('text-paymee-cyan','text-gray-400'); text.classList.replace('text-paymee-cyan','text-gray-400'); }
      });
    };

    const renderScreen = (targetId)=>{
      const current=document.getElementById(currentScreen);
      const target=document.getElementById(targetId);
      if(!target || targetId===currentScreen) return;

      const showNavbar=['home-dashboard','collect-amount','history','daily-summary'].includes(targetId);
      document.getElementById('main-navbar').style.display = showNavbar ? 'flex':'none';
      updateNavHighlight(targetId);

      const amountInPesos=(parseFloat(amount)/100).toFixed(2);
      const displayValue=formatAmount(amountInPesos);
      if(targetId==='collect-method')      document.getElementById('method-amount-display').textContent=displayValue;
      else if(targetId==='qr-sim')         document.getElementById('qr-amount-display').textContent=displayValue;
      else if(targetId==='nfc-sim')        document.getElementById('nfc-amount-display').textContent=displayValue;
      else if(targetId==='success')        document.getElementById('success-amount-display').textContent=displayValue;
      else if(targetId==='receipt'){
        const r=calculateReceipt(amount);
        document.getElementById('receipt-total').textContent=r.total;
        document.getElementById('receipt-fee').textContent=r.fee;
        document.getElementById('receipt-net').textContent=r.net;
        document.getElementById('receipt-method').textContent=r.method;
        document.getElementById('receipt-date').textContent=new Date().toLocaleString('es-AR',{day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit',hour12:true});
      } else if(targetId==='collect-amount'){ updateDisplay(); }

      current.classList.remove('active'); target.classList.add('active'); currentScreen=targetId;
      if(targetId==='home-dashboard') amount='000';
    };

    // INIT
    document.addEventListener('DOMContentLoaded',()=>{
      document.querySelectorAll('.key-button').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const value=btn.getAttribute('data-value')||btn.getAttribute('data-action');
          handleKeyPress(value);
        });
      });

      document.getElementById('main-navbar').style.display='none'; // oculto en splash/welcome

      setTimeout(()=>{
        document.getElementById('splash-screen').classList.remove('active');
        document.getElementById('splash-screen').style.transform='translateX(-100%)';
        document.getElementById('welcome').classList.add('active');
        document.getElementById('welcome').style.transform='translateX(0)';
        currentScreen='welcome';
      },1500);

      updateDisplay();
      initHistory();
    });
  </script>
</body>
</html>